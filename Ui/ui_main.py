# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'ui_main.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QMainWindow
from thread_part.sql_ui_method import SqlThread
from thread_part.xss_ui_method import XssThread
from thread_part.js_ui_method import JsThread


class UiMainWindow(object):
    def __init__(self):
        self.MainWindow = QMainWindow()
        self.setupUi(self.MainWindow)

        self.xss_thread = None
        self.sql_thread = None
        self.js_thread = None

    def show(self):
        self.MainWindow.show()

    # 定义SQL线程创建函数
    def start_sql_thread(self, url, **kwargs):  # 魔法变量（**kwargs）处理不定长度键值对
        # 创建线程
        self.sql_thread = SqlThread(url, **kwargs)
        self.sql_thread.res_signal.connect(self.sql_progress)
        self.sql_thread.end_signal.connect(self.thread_status)
        # 开始子线程
        self.sql_thread.start()

    def sql_progress(self, msg):
        self.sql_scan_result.insertPlainText(msg + '\n')  # 将线程的参数传入结果框，实时UI显示结果

    # 定义XSS线程创建函数
    def start_xss_thread(self, url, **kwargs):  # 魔法变量（**kwargs）处理不定长度键值对
        # 创建线程
        self.xss_thread = XssThread(url, **kwargs)
        self.xss_thread.res_signal.connect(self.xss_progress)
        self.xss_thread.end_signal.connect(self.thread_status)
        # 开始子线程
        self.xss_thread.start()

    def xss_progress(self, msg):
        self.xss_scan_result.insertPlainText(msg + '\n')  # 将线程的参数传入结果框，实时UI显示结果

    # 定义JS线程创建函数

    def start_js_thread(self, url, **kwargs):  # 魔法变量（**kwargs）处理不定长度键值对
        # 创建线程
        self.js_thread = JsThread(url, **kwargs)
        self.js_thread.res_signal.connect(self.js_progress)
        self.js_thread.end_signal.connect(self.thread_status)
        # 开始子线程
        self.js_thread.start()

    def js_progress(self, msg):
        # print(msg)
        self.js_scan_result.insertPlainText(msg + '\n')  # 将线程的参数传入结果框，实时UI显示结果

    def thread_status(self, flag):
        # print(flag)
        self.xss_start_button.setEnabled(flag)
        self.sql_start_button.setEnabled(flag)
        self.js_start_button.setEnabled(flag)

    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1103, 828)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.tableWidget = QtWidgets.QTableWidget(self.centralwidget)
        self.tableWidget.setGeometry(QtCore.QRect(0, -20, 991, 671))
        self.tableWidget.setObjectName("tableWidget")
        self.tableWidget.setColumnCount(0)
        self.tableWidget.setRowCount(0)
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(0, 0, 1101, 801))
        font = QtGui.QFont()
        font.setPointSize(11)
        self.tabWidget.setFont(font)
        self.tabWidget.setObjectName("tabWidget")
        self.sql_tab = QtWidgets.QWidget()
        self.sql_tab.setObjectName("sql_tab")
        self.sql_url = QtWidgets.QLineEdit(self.sql_tab)
        self.sql_url.setGeometry(QtCore.QRect(200, 20, 781, 41))
        self.sql_url.setToolTip("")
        self.sql_url.setObjectName("sql_url")
        self.url_1 = QtWidgets.QLabel(self.sql_tab)
        self.url_1.setGeometry(QtCore.QRect(10, 20, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.url_1.setFont(font)
        self.url_1.setToolTip("")
        self.url_1.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.url_1.setTextFormat(QtCore.Qt.PlainText)
        self.url_1.setObjectName("url_1")
        self.sql_data = QtWidgets.QLineEdit(self.sql_tab)
        self.sql_data.setGeometry(QtCore.QRect(200, 90, 781, 41))
        self.sql_data.setToolTip("")
        self.sql_data.setObjectName("sql_data")
        self.sql_user_agent = QtWidgets.QLineEdit(self.sql_tab)
        self.sql_user_agent.setGeometry(QtCore.QRect(200, 230, 781, 41))
        self.sql_user_agent.setToolTip("")
        self.sql_user_agent.setObjectName("sql_user_agent")
        self.sql_cookie = QtWidgets.QLineEdit(self.sql_tab)
        self.sql_cookie.setGeometry(QtCore.QRect(200, 160, 781, 41))
        self.sql_cookie.setToolTip("")
        self.sql_cookie.setObjectName("sql_cookie")
        self.sql_referer = QtWidgets.QLineEdit(self.sql_tab)
        self.sql_referer.setGeometry(QtCore.QRect(200, 300, 781, 41))
        self.sql_referer.setToolTip("")
        self.sql_referer.setObjectName("sql_referer")
        self.data_1 = QtWidgets.QLabel(self.sql_tab)
        self.data_1.setGeometry(QtCore.QRect(10, 90, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.data_1.setFont(font)
        self.data_1.setToolTip("")
        self.data_1.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.data_1.setTextFormat(QtCore.Qt.PlainText)
        self.data_1.setObjectName("data_1")
        self.cookie_1 = QtWidgets.QLabel(self.sql_tab)
        self.cookie_1.setGeometry(QtCore.QRect(10, 160, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.cookie_1.setFont(font)
        self.cookie_1.setToolTip("")
        self.cookie_1.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.cookie_1.setTextFormat(QtCore.Qt.PlainText)
        self.cookie_1.setObjectName("cookie_1")
        self.user_agent_1 = QtWidgets.QLabel(self.sql_tab)
        self.user_agent_1.setGeometry(QtCore.QRect(10, 230, 171, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.user_agent_1.setFont(font)
        self.user_agent_1.setToolTip("")
        self.user_agent_1.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.user_agent_1.setTextFormat(QtCore.Qt.PlainText)
        self.user_agent_1.setObjectName("user_agent_1")
        self.referer_1 = QtWidgets.QLabel(self.sql_tab)
        self.referer_1.setGeometry(QtCore.QRect(10, 300, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.referer_1.setFont(font)
        self.referer_1.setToolTip("")
        self.referer_1.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.referer_1.setTextFormat(QtCore.Qt.PlainText)
        self.referer_1.setObjectName("referer_1")
        self.sql_start_button = QtWidgets.QPushButton(self.sql_tab)
        self.sql_start_button.setGeometry(QtCore.QRect(430, 430, 151, 41))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.sql_start_button.setFont(font)
        self.sql_start_button.setObjectName("sql_start_button")
        self.sql_scan_result = QtWidgets.QPlainTextEdit(self.sql_tab)
        self.sql_scan_result.setGeometry(QtCore.QRect(20, 490, 1041, 241))
        self.sql_scan_result.setObjectName("sql_scan_result")
        self.label_21 = QtWidgets.QLabel(self.sql_tab)
        self.label_21.setGeometry(QtCore.QRect(990, 20, 91, 41))
        self.label_21.setObjectName("label_21")
        self.proxy_1 = QtWidgets.QLabel(self.sql_tab)
        self.proxy_1.setGeometry(QtCore.QRect(10, 370, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.proxy_1.setFont(font)
        self.proxy_1.setToolTip("")
        self.proxy_1.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.proxy_1.setTextFormat(QtCore.Qt.PlainText)
        self.proxy_1.setObjectName("proxy_1")
        self.sql_proxy = QtWidgets.QLineEdit(self.sql_tab)
        self.sql_proxy.setGeometry(QtCore.QRect(200, 370, 781, 41))
        self.sql_proxy.setToolTip("")
        self.sql_proxy.setObjectName("sql_proxy")
        self.tabWidget.addTab(self.sql_tab, "")
        self.xss_tab = QtWidgets.QWidget()
        self.xss_tab.setObjectName("xss_tab")
        self.url_2 = QtWidgets.QLabel(self.xss_tab)
        self.url_2.setGeometry(QtCore.QRect(10, 20, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.url_2.setFont(font)
        self.url_2.setToolTip("")
        self.url_2.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.url_2.setTextFormat(QtCore.Qt.PlainText)
        self.url_2.setObjectName("url_2")
        self.xss_start_button = QtWidgets.QPushButton(self.xss_tab)
        self.xss_start_button.setGeometry(QtCore.QRect(430, 430, 151, 41))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.xss_start_button.setFont(font)
        self.xss_start_button.setObjectName("xss_start_button")
        self.user_agent_2 = QtWidgets.QLabel(self.xss_tab)
        self.user_agent_2.setGeometry(QtCore.QRect(10, 230, 171, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.user_agent_2.setFont(font)
        self.user_agent_2.setToolTip("")
        self.user_agent_2.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.user_agent_2.setTextFormat(QtCore.Qt.PlainText)
        self.user_agent_2.setObjectName("user_agent_2")
        self.label_22 = QtWidgets.QLabel(self.xss_tab)
        self.label_22.setGeometry(QtCore.QRect(990, 20, 91, 41))
        self.label_22.setObjectName("label_22")
        self.xss_cookie = QtWidgets.QLineEdit(self.xss_tab)
        self.xss_cookie.setGeometry(QtCore.QRect(200, 160, 781, 41))
        self.xss_cookie.setToolTip("")
        self.xss_cookie.setObjectName("xss_cookie")
        self.xss_url = QtWidgets.QLineEdit(self.xss_tab)
        self.xss_url.setGeometry(QtCore.QRect(200, 20, 781, 41))
        self.xss_url.setToolTip("")
        self.xss_url.setObjectName("xss_url")
        self.data_2 = QtWidgets.QLabel(self.xss_tab)
        self.data_2.setGeometry(QtCore.QRect(10, 90, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.data_2.setFont(font)
        self.data_2.setToolTip("")
        self.data_2.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.data_2.setTextFormat(QtCore.Qt.PlainText)
        self.data_2.setObjectName("data_2")
        self.xss_data = QtWidgets.QLineEdit(self.xss_tab)
        self.xss_data.setGeometry(QtCore.QRect(200, 90, 781, 41))
        self.xss_data.setToolTip("")
        self.xss_data.setObjectName("xss_data")
        self.xss_referer = QtWidgets.QLineEdit(self.xss_tab)
        self.xss_referer.setGeometry(QtCore.QRect(200, 300, 781, 41))
        self.xss_referer.setToolTip("")
        self.xss_referer.setObjectName("xss_referer")
        self.xss_scan_result = QtWidgets.QPlainTextEdit(self.xss_tab)
        self.xss_scan_result.setGeometry(QtCore.QRect(20, 490, 1041, 241))
        self.xss_scan_result.setObjectName("xss_scan_result")
        self.referer_2 = QtWidgets.QLabel(self.xss_tab)
        self.referer_2.setGeometry(QtCore.QRect(10, 300, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.referer_2.setFont(font)
        self.referer_2.setToolTip("")
        self.referer_2.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.referer_2.setTextFormat(QtCore.Qt.PlainText)
        self.referer_2.setObjectName("referer_2")
        self.cookie_2 = QtWidgets.QLabel(self.xss_tab)
        self.cookie_2.setGeometry(QtCore.QRect(10, 160, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.cookie_2.setFont(font)
        self.cookie_2.setToolTip("")
        self.cookie_2.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.cookie_2.setTextFormat(QtCore.Qt.PlainText)
        self.cookie_2.setObjectName("cookie_2")
        self.xss_user_agent = QtWidgets.QLineEdit(self.xss_tab)
        self.xss_user_agent.setGeometry(QtCore.QRect(200, 230, 781, 41))
        self.xss_user_agent.setToolTip("")
        self.xss_user_agent.setObjectName("xss_user_agent")
        self.proxy_2 = QtWidgets.QLabel(self.xss_tab)
        self.proxy_2.setGeometry(QtCore.QRect(10, 370, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.proxy_2.setFont(font)
        self.proxy_2.setToolTip("")
        self.proxy_2.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.proxy_2.setTextFormat(QtCore.Qt.PlainText)
        self.proxy_2.setObjectName("proxy_2")
        self.xss_proxy = QtWidgets.QLineEdit(self.xss_tab)
        self.xss_proxy.setGeometry(QtCore.QRect(200, 370, 781, 41))
        self.xss_proxy.setToolTip("")
        self.xss_proxy.setObjectName("xss_proxy")
        self.tabWidget.addTab(self.xss_tab, "")
        self.js_tab = QtWidgets.QWidget()
        self.js_tab.setObjectName("js_tab")
        self.url_3 = QtWidgets.QLabel(self.js_tab)
        self.url_3.setGeometry(QtCore.QRect(10, 20, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.url_3.setFont(font)
        self.url_3.setToolTip("")
        self.url_3.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.url_3.setTextFormat(QtCore.Qt.PlainText)
        self.url_3.setObjectName("url_3")
        self.js_start_button = QtWidgets.QPushButton(self.js_tab)
        self.js_start_button.setGeometry(QtCore.QRect(430, 430, 151, 41))
        font = QtGui.QFont()
        font.setPointSize(11)
        font.setBold(True)
        font.setWeight(75)
        self.js_start_button.setFont(font)
        self.js_start_button.setObjectName("js_start_button")
        self.user_agent_3 = QtWidgets.QLabel(self.js_tab)
        self.user_agent_3.setGeometry(QtCore.QRect(10, 160, 171, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.user_agent_3.setFont(font)
        self.user_agent_3.setToolTip("")
        self.user_agent_3.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.user_agent_3.setTextFormat(QtCore.Qt.PlainText)
        self.user_agent_3.setObjectName("user_agent_3")
        self.label_23 = QtWidgets.QLabel(self.js_tab)
        self.label_23.setGeometry(QtCore.QRect(990, 20, 91, 41))
        self.label_23.setObjectName("label_23")
        self.js_cookie = QtWidgets.QLineEdit(self.js_tab)
        self.js_cookie.setGeometry(QtCore.QRect(200, 90, 781, 41))
        self.js_cookie.setToolTip("")
        self.js_cookie.setObjectName("js_cookie")
        self.js_url = QtWidgets.QLineEdit(self.js_tab)
        self.js_url.setGeometry(QtCore.QRect(200, 20, 781, 41))
        self.js_url.setToolTip("")
        self.js_url.setObjectName("js_url")
        self.proxy_3 = QtWidgets.QLabel(self.js_tab)
        self.proxy_3.setGeometry(QtCore.QRect(10, 300, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.proxy_3.setFont(font)
        self.proxy_3.setToolTip("")
        self.proxy_3.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.proxy_3.setTextFormat(QtCore.Qt.PlainText)
        self.proxy_3.setObjectName("proxy_3")
        self.js_proxy = QtWidgets.QLineEdit(self.js_tab)
        self.js_proxy.setGeometry(QtCore.QRect(200, 300, 781, 41))
        self.js_proxy.setToolTip("")
        self.js_proxy.setObjectName("js_proxy")
        self.js_referer = QtWidgets.QLineEdit(self.js_tab)
        self.js_referer.setGeometry(QtCore.QRect(200, 230, 781, 41))
        self.js_referer.setToolTip("")
        self.js_referer.setObjectName("js_referer")
        self.js_scan_result = QtWidgets.QPlainTextEdit(self.js_tab)
        self.js_scan_result.setGeometry(QtCore.QRect(20, 490, 1041, 241))
        self.js_scan_result.setObjectName("js_scan_result")
        self.referer_3 = QtWidgets.QLabel(self.js_tab)
        self.referer_3.setGeometry(QtCore.QRect(10, 230, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.referer_3.setFont(font)
        self.referer_3.setToolTip("")
        self.referer_3.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.referer_3.setTextFormat(QtCore.Qt.PlainText)
        self.referer_3.setObjectName("referer_3")
        self.cookie_3 = QtWidgets.QLabel(self.js_tab)
        self.cookie_3.setGeometry(QtCore.QRect(10, 90, 141, 41))
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold SemiConden")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.cookie_3.setFont(font)
        self.cookie_3.setToolTip("")
        self.cookie_3.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.cookie_3.setTextFormat(QtCore.Qt.PlainText)
        self.cookie_3.setObjectName("cookie_3")
        self.js_user_agent = QtWidgets.QLineEdit(self.js_tab)
        self.js_user_agent.setGeometry(QtCore.QRect(200, 160, 781, 41))
        self.js_user_agent.setToolTip("")
        self.js_user_agent.setObjectName("js_user_agent")
        self.tabWidget.addTab(self.js_tab, "")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1103, 26))
        self.menubar.setObjectName("menubar")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(1)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.url_1.setText(_translate("MainWindow", "    URL:"))
        self.data_1.setText(_translate("MainWindow", "    DATA:"))
        self.cookie_1.setText(_translate("MainWindow", "    COOKIE:"))
        self.user_agent_1.setText(_translate("MainWindow", "    USER-AGENT:"))
        self.referer_1.setText(_translate("MainWindow", "    REFERER:"))
        self.sql_start_button.setText(_translate("MainWindow", "开始扫描"))
        self.label_21.setText(_translate("MainWindow", "*"))
        self.proxy_1.setText(_translate("MainWindow", "    PROXY:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.sql_tab), _translate("MainWindow", "SQL注入"))
        self.url_2.setText(_translate("MainWindow", "    URL:"))
        self.xss_start_button.setText(_translate("MainWindow", "开始扫描"))
        self.user_agent_2.setText(_translate("MainWindow", "    USER-AGENT:"))
        self.label_22.setText(_translate("MainWindow", "*"))
        self.data_2.setText(_translate("MainWindow", "    DATA:"))
        self.referer_2.setText(_translate("MainWindow", "    REFERER:"))
        self.cookie_2.setText(_translate("MainWindow", "    COOKIE:"))
        self.proxy_2.setText(_translate("MainWindow", "    PROXY:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.xss_tab), _translate("MainWindow", "XSS"))
        self.url_3.setText(_translate("MainWindow", "    URL:"))
        self.js_start_button.setText(_translate("MainWindow", "开始扫描"))
        self.user_agent_3.setText(_translate("MainWindow", "    USER-AGENT:"))
        self.label_23.setText(_translate("MainWindow", "*"))
        self.proxy_3.setText(_translate("MainWindow", "    PROXY:"))
        self.referer_3.setText(_translate("MainWindow", "    REFERER:"))
        self.cookie_3.setText(_translate("MainWindow", "    COOKIE:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.js_tab), _translate("MainWindow", "JS扫描"))
